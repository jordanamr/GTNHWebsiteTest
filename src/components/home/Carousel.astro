---
import CarouselItem from "./CarouselItem.astro";
import { Image } from "astro:assets";

import image1 from "../../assets/home/carousel/1.png";
import image2 from "../../assets/home/carousel/2.png";
import image3 from "../../assets/home/carousel/3.png";
import image4 from "../../assets/home/carousel/4.png";
import image5 from "../../assets/home/carousel/5.png";

// Slideshow speed in milliseconds
const SLIDESHOW_SPEED = 5000;
---

<div class="rounded-2xl p-4">
  <div class="carousel-container relative overflow-hidden rounded-xl">
    <!-- Carousel Images -->
    <div class="carousel-track flex transition-transform duration-500 ease-in-out" id="carousel-track">
      <CarouselItem title="Amazing Build #1" author="Builder1">
        <Image src={image1} alt="" loading="eager" class="w-full h-full object-cover" />
      </CarouselItem>
      <CarouselItem title="Amazing Build #2" author="Builder2">
        <Image src={image2} alt="" loading="eager" class="w-full h-full object-cover" />
      </CarouselItem>
      <CarouselItem title="Amazing Build #3" author="Builder3">
        <Image src={image3} alt="" loading="eager" class="w-full h-full object-cover" />
      </CarouselItem>
      <CarouselItem title="Amazing Build #4" author="Builder4">
        <Image src={image4} alt="" loading="eager" class="w-full h-full object-cover" />
      </CarouselItem>
      <CarouselItem title="Amazing Build #5" author="Builder5">
        <Image src={image5} alt="" loading="eager" class="w-full h-full object-cover" />
      </CarouselItem>
    </div>
  </div>
</div>

<script is:inline define:vars={{ SLIDESHOW_SPEED }}>
  let currentSlide = 0;
  let totalSlides = 0;
  let track = null;

  function initializeSlideshow() {
    track = document.getElementById("carousel-track");
    totalSlides = document.querySelectorAll(".carousel-slide").length;

    // Start auto-advance slideshow
    if (totalSlides > 1) {
      setInterval(nextSlide, SLIDESHOW_SPEED);
    }
  }

  function updateSlideshow() {
    if (track && totalSlides > 0) {
      track.style.transform = `translateX(-${currentSlide * 100}%)`;
    }
  }

  function nextSlide() {
    if (totalSlides > 0) {
      currentSlide = (currentSlide + 1) % totalSlides;
      updateSlideshow();
    }
  }

  // Initialize when DOM is loaded
  document.addEventListener("DOMContentLoaded", () => {
    initializeSlideshow();
  });
</script>
